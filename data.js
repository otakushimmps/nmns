// 資料來源與設備規格
// 如需新增或調整設備，請在本檔案編輯。

// === 基礎資料 ===
// --- AHU DATABASE ---
const ahuDatabase = {
  "AH-01": { cmh: "≥26,500", pa: "500", kw: "≥232", motor: "≤3.35*4 kW (EC)" },
  "AH-02": { cmh: "≥27,800", pa: "500", kw: "≥256", motor: "≤4.4*3 kW (EC)" },
  "AH-06": { cmh: "≥16,600", pa: "500", kw: "≥152", motor: "≤5.25*2 kW (EC)" },
  "AH-11": { cmh: "≥23,200", pa: "450", kw: "≥196", motor: "≤4.5*3 kW (EC)" },
  "AH-13": { cmh: "≥7,700", pa: "400", kw: "≥70", motor: "≤4.4*1 kW (EC)" },
  "AH-14": { cmh: "≥6,600", pa: "400", kw: "≥60", motor: "≤3.35*1 kW (EC)" },
  "AH-15": { cmh: "≥11,400", pa: "550", kw: "≥84", motor: "≤3.35*2 kW (EC)", heater: "30", humid: "5.0", humidKw: "3.75" },
  "AH-17": { cmh: "≥39,250", pa: "450", kw: "≥358", motor: "≤5.0*3 kW (EC)" },
  "AH-18": { cmh: "≥12,000", pa: "450", kw: "≥109", motor: "≤3.35*2 kW (EC)" },
  "AH-19": { cmh: "≥25,500", pa: "600", kw: "≥190", motor: "3.35*3 kW (EC)", heater: "72", humid: "10", humidKw: "7.5" },
  "AH-21": { cmh: "≥10,500", pa: "450", kw: "≥95", motor: "≤5.0*1 kW (EC)" },
  "AH-22": { cmh: "≥22,800", pa: "500", kw: "≥210", motor: "≤5.0*2 kW (EC)" },
  "AH-23": { cmh: "≥19,800", pa: "500", kw: "≥183", motor: "≤5.0*2 kW (EC)" },
  "AH-25": { cmh: "≥24,500", pa: "450", kw: "≥208", motor: "≤5.25*3 kW (EC)" },
  "AH-26": { cmh: "≥24,500", pa: "450", kw: "≥208", motor: "≤5.25*3 kW (EC)" },
  "AH-27": { cmh: "≥38,400", pa: "500", kw: "≥327", motor: "≤5.25*4 kW (EC)" },
  "AH-29": { cmh: "≥14,300", pa: "450", kw: "≥130", motor: "≤3.35*2 kW (EC)" },
  "AH-30": { cmh: "≥8,600", pa: "500", kw: "≥70", motor: "≤3.35*2 kW (EC)", heater: "24", humid: "5.0", humidKw: "3.75" },
  "AH-32": { cmh: "≥9,200", pa: "450", kw: "≥84", motor: "≤4.0*1 kW (EC)" },
  "AH-35": { cmh: "≥20,400", pa: "400", kw: "≥186", motor: "≤5.0*2 kW (EC)" },
  "AH-36": { cmh: "≥18,000", pa: "450", kw: "≥158", motor: "≤5.25*2 kW (EC)" },
  "AH-37": { cmh: "≥12,800", pa: "450", kw: "≥109", motor: "≤3.35*2 kW (EC)" },
  "AH-38": { cmh: "≥23,200", pa: "450", kw: "≥214", motor: "≤5.0*2 kW (EC)" },
  "AH-39": { cmh: "≥18,000", pa: "450", kw: "≥158", motor: "≤5.25*2 kW (EC)" },
  "AH-40": { cmh: "≥25,200", pa: "450", kw: "≥214", motor: "≤5.25*3 kW (EC)" },
  "AH-41": { cmh: "≥24,200", pa: "450", kw: "≥208", motor: "≤5.25*3 kW (EC)" },
  "AH-46": { cmh: "≥13,600", pa: "600", kw: "≥102", motor: "≤4.5*2 kW (EC)", heater: "45", humid: "5.0", humidKw: "3.75" },
  "AH-47": { cmh: "≥29,500", pa: "450", kw: "≥270", motor: "≤4.4*3 kW (EC)" },
  "AH-48": { cmh: "≥16,600", pa: "450", kw: "≥150", motor: "≤5.0*2 kW (EC)" },
  "AH-49": { cmh: "≥17,800", pa: "600", kw: "≥133", motor: "≤3.35*3 kW (EC)", heater: "60", humid: "5.0", humidKw: "3.75" },
  "AH-50": { cmh: "≥14,500", pa: "400", kw: "≥133", motor: "≤4.5*2 kW (EC)" },
  "AH-51": { cmh: "≥14,500", pa: "400", kw: "≥133", motor: "≤4.5*2 kW (EC)" },
  "AH-52": { cmh: "≥12,000", pa: "400", kw: "≥109", motor: "≤3.35*2 kW (EC)" },
};

// --- Factory Data ---
// === 頁籤分類與固定設備 ===
// 僅放固定設備；動態設備由下方 config 產生。
const defaultAppData = {
  tab1: {
    title: "1. 冰水主機群 (Chillers)",
    desc: "冰水主機驗收 (共10台)",
    items: [
      {
        id: "BCH-1", name: "水冷式儲冰主機",
        basicInfo: { "型號": "需現場確認", "製冷能力": "600 RT", "冷媒種類": "環保冷媒 (GWP<1450)", "電源": "480V / 3Ø / 60Hz", "COP": "≧ 5.16" },
        checkItems: [
          "銘牌規格與設計相符",
          "葉輪 (Impeller)： 須經靜力及動力平衡，並通過 15% 之超速測試證明",
          "軸承 (Bearing)： 滷水機組（BCH）需採用襯套軸承",
          "冷凝器 (Condenser)： 水冷殼管式，2 通（PASS）式，水側設計壓力不小於 1,034 kPa (150 psig)",
          "蒸發器 (Evaporator)： 殼管式，2 通（PASS）式，水側設計壓力不小於 1,034 kPa (150 psig)，且低溫管路需作保溫處理",
          "冷媒系統： 採用環境部認可之環保冷媒。壓縮機出口端需安裝關斷閥，維修時可將冷媒儲存於冷凝器內",
          "啟動電流： 必須採用變頻啟動，確保起動電流不超過 2A",
          "電流限制： 具備負載限制設定裝置，可手動設定最大運轉電流於滿載電流之 15% 至 100% 之間",
          "馬達保護： 具備防止電源相序逆向運轉保護，且馬達在最大制動馬力下能作 30 分鐘間隔之連續啟停",
          "噪音標準： 全負載噪音不得超過 87 dBA",
          "真空測試： 需使用高真空泵產生 100μm 水柱之真空度，維持 24 小時後之損失不得超過 50μm 水柱",
          "振動標準： 壓縮機運轉振動量評估應符合 ISO 10816-1 區域 B 之規定",
          "通訊功能： 支援 MODBUS-RTU、MODBUS-TCP/IP 或 BACnet 開放式通訊協定，並可透過 Web 瀏覽器進行遠端操作管理",
        ]
      },
      {
        id: "BCH-2", name: "水冷式儲冰主機",
        basicInfo: { "型號": "需現場確認", "製冷能力": "600 RT", "冷媒種類": "環保冷媒 (GWP<1450)", "電源": "480V / 3Ø / 60Hz", "COP": "≧ 5.16" },
        checkItems: [
          "銘牌規格與設計相符",
          "葉輪 (Impeller)： 須經靜力及動力平衡，並通過 15% 之超速測試證明",
          "軸承 (Bearing)： 滷水機組（BCH）需採用襯套軸承",
          "冷凝器 (Condenser)： 水冷殼管式，2 通（PASS）式，水側設計壓力不小於 1,034 kPa (150 psig)",
          "蒸發器 (Evaporator)： 殼管式，2 通（PASS）式，水側設計壓力不小於 1,034 kPa (150 psig)，且低溫管路需作保溫處理",
          "冷媒系統： 採用環境部認可之環保冷媒。壓縮機出口端需安裝關斷閥，維修時可將冷媒儲存於冷凝器內",
          "啟動電流： 必須採用變頻啟動，確保起動電流不超過 2A",
          "電流限制： 具備負載限制設定裝置，可手動設定最大運轉電流於滿載電流之 15% 至 100% 之間",
          "馬達保護： 具備防止電源相序逆向運轉保護，且馬達在最大制動馬力下能作 30 分鐘間隔之連續啟停",
          "噪音標準： 全負載噪音不得超過 87 dBA",
          "真空測試： 需使用高真空泵產生 100μm 水柱之真空度，維持 24 小時後之損失不得超過 50μm 水柱",
          "振動標準： 壓縮機運轉振動量評估應符合 ISO 10816-1 區域 B 之規定",
          "通訊功能： 支援 MODBUS-RTU、MODBUS-TCP/IP 或 BACnet 開放式通訊協定，並可透過 Web 瀏覽器進行遠端操作管理",
        ]
      },
      {
        id: "CH-3", name: "磁浮離心式冰水主機",
        basicInfo: { "型號": "需現場確認", "製冷能力": "400 RT", "冷媒種類": "環保冷媒 (GWP<1450)", "電源": "480V / 3Ø / 60Hz", "軸承型式": "磁浮無油軸承", "COP": "≧ 7.1" },
        checkItems: [
          "銘牌規格與設計相符",
          "無油磁浮軸承，具備自動對位及內部軸承多點定位偵測器",
          "葉輪須經靜力及動力平衡，並通過 15% 超速測試",
          "冷凝器 (Condenser)： 水冷殼管式，2 通（PASS）式，水側設計壓力不小於 1,034 kPa (150 psig)",
          "蒸發器 (Evaporator)： 殼管式，2 通（PASS）式，水側設計壓力不小於 1,034 kPa (150 psig)，且低溫管路需作保溫處理",
          "冷媒系統： 採用環境部認可之環保冷媒。壓縮機出口端需安裝關斷閥，維修時可將冷媒儲存於冷凝器內",
          "啟動電流： 必須採用變頻啟動，確保起動電流不超過 2A",
          "電流限制： 具備負載限制設定裝置，可手動設定最大運轉電流於滿載電流之 15% 至 100% 之間",
          "馬達保護： 具備防止電源相序逆向運轉保護，且馬達在最大制動馬力下能作 30 分鐘間隔之連續啟停",
          "噪音標準： 全負載噪音不得超過 87 dBA",
          "真空測試： 需使用高真空泵產生 100μm 水柱之真空度，維持 24 小時後之損失不得超過 50μm 水柱",
          "振動標準： 壓縮機運轉振動量評估應符合 ISO 10816-1 區域 B 之規定",
          "通訊功能： 支援 MODBUS-RTU、MODBUS-TCP/IP 或 BACnet 開放式通訊協定，並可透過 Web 瀏覽器進行遠端操作管理",
        ]
      },
      {
        id: "CH-4", name: "磁浮離心式冰水主機",
        basicInfo: { "型號": "需現場確認", "製冷能力": "400 RT", "冷媒種類": "環保冷媒 (GWP<1450)", "電源": "480V / 3Ø / 60Hz", "軸承型式": "磁浮無油軸承", "COP": "≧ 7.1" },
        checkItems: [
          "銘牌規格與設計相符",
          "無油磁浮軸承，具備自動對位及內部軸承多點定位偵測器",
          "葉輪須經靜力及動力平衡，並通過 15% 超速測試",
          "冷凝器 (Condenser)： 水冷殼管式，2 通（PASS）式，水側設計壓力不小於 1,034 kPa (150 psig)",
          "蒸發器 (Evaporator)： 殼管式，2 通（PASS）式，水側設計壓力不小於 1,034 kPa (150 psig)，且低溫管路需作保溫處理",
          "冷媒系統： 採用環境部認可之環保冷媒。壓縮機出口端需安裝關斷閥，維修時可將冷媒儲存於冷凝器內",
          "啟動電流： 必須採用變頻啟動，確保起動電流不超過 2A",
          "電流限制： 具備負載限制設定裝置，可手動設定最大運轉電流於滿載電流之 15% 至 100% 之間",
          "馬達保護： 具備防止電源相序逆向運轉保護，且馬達在最大制動馬力下能作 30 分鐘間隔之連續啟停",
          "噪音標準： 全負載噪音不得超過 87 dBA",
          "真空測試： 需使用高真空泵產生 100μm 水柱之真空度，維持 24 小時後之損失不得超過 50μm 水柱",
          "振動標準： 壓縮機運轉振動量評估應符合 ISO 10816-1 區域 B 之規定",
          "通訊功能： 支援 MODBUS-RTU、MODBUS-TCP/IP 或 BACnet 開放式通訊協定，並可透過 Web 瀏覽器進行遠端操作管理",
        ]
      },
      {
        id: "ACH-1-1", name: "氣冷變頻式冰水主機 #1-1",
        basicInfo: { "製冷能力": "135 kW", "輸入功率": "45KW", "壓縮機": "1定2變頻", "電源": "480V / 3Ø / 60Hz", "冷媒": "R410a", "COP": "3.0" },
        checkItems: [
          "銘牌規格與設計相符",
          "防蝕處理： 散熱鋁片須進行防蝕處理（如藍色鰭片），底盤與機架應採用耐蝕材質或經防銹處理",
          "變頻調節功能： 主機須具備變頻（Inverter）驅動，可根據空調負載需求自動調整壓縮機轉速，以達到節能效果",
          "保護功能： 需具備高低壓力保護、防凍保護、過載保護、欠相保護及自動復歸功能",
          "避震安裝： 主機須安裝於原廠提供之彈簧式避震器上，以減少運轉振動傳遞至建築結構",
          "空間留設： 散熱進出風口須依原廠要求留設足夠空間，避免熱氣短循環影響效率",
          "真空維持測試，停止泵運轉後維持 24 小時，真空度損失不得超過 50μm 水柱",
          "散熱鰭片的完整性（無倒片或壓傷）",
          "外部電源接線箱的防水等級"
        ]
      },
      {
        id: "ACH-1-2", name: "氣冷變頻式冰水主機 #1-2",
        basicInfo: { "製冷能力": "135 kW", "輸入功率": "45KW", "壓縮機": "1定2變頻", "電源": "480V / 3Ø / 60Hz", "冷媒": "R410a", "COP": "3.0" },
        checkItems: [
          "銘牌規格與設計相符",
          "防蝕處理： 散熱鋁片須進行防蝕處理（如藍色鰭片），底盤與機架應採用耐蝕材質或經防銹處理",
          "變頻調節功能： 主機須具備變頻（Inverter）驅動，可根據空調負載需求自動調整壓縮機轉速，以達到節能效果",
          "保護功能： 需具備高低壓力保護、防凍保護、過載保護、欠相保護及自動復歸功能",
          "避震安裝： 主機須安裝於原廠提供之彈簧式避震器上，以減少運轉振動傳遞至建築結構",
          "空間留設： 散熱進出風口須依原廠要求留設足夠空間，避免熱氣短循環影響效率",
          "真空維持測試，停止泵運轉後維持 24 小時，真空度損失不得超過 50μm 水柱",
          "散熱鰭片的完整性（無倒片或壓傷）",
          "外部電源接線箱的防水等級"
        ]
      },
      {
        id: "ACH-1-3", name: "氣冷變頻式冰水主機 #1-3",
        basicInfo: { "製冷能力": "135 kW", "輸入功率": "45KW", "壓縮機": "1定2變頻", "電源": "480V / 3Ø / 60Hz", "冷媒": "R410a", "COP": "3.0" },
        checkItems: [
          "銘牌規格與設計相符",
          "防蝕處理： 散熱鋁片須進行防蝕處理（如藍色鰭片），底盤與機架應採用耐蝕材質或經防銹處理",
          "變頻調節功能： 主機須具備變頻（Inverter）驅動，可根據空調負載需求自動調整壓縮機轉速，以達到節能效果",
          "保護功能： 需具備高低壓力保護、防凍保護、過載保護、欠相保護及自動復歸功能",
          "避震安裝： 主機須安裝於原廠提供之彈簧式避震器上，以減少運轉振動傳遞至建築結構",
          "空間留設： 散熱進出風口須依原廠要求留設足夠空間，避免熱氣短循環影響效率",
          "真空維持測試，停止泵運轉後維持 24 小時，真空度損失不得超過 50μm 水柱",
          "散熱鰭片的完整性（無倒片或壓傷）",
          "外部電源接線箱的防水等級"
        ]
      },
      {
        id: "ACH-1-4", name: "氣冷變頻式冰水主機 #1-4",
        basicInfo: { "製冷能力": "135 kW", "輸入功率": "45KW", "壓縮機": "1定2變頻", "電源": "480V / 3Ø / 60Hz", "冷媒": "R410a", "COP": "3.0" },
        checkItems: [
          "銘牌規格與設計相符",
          "防蝕處理： 散熱鋁片須進行防蝕處理（如藍色鰭片），底盤與機架應採用耐蝕材質或經防銹處理",
          "變頻調節功能： 主機須具備變頻（Inverter）驅動，可根據空調負載需求自動調整壓縮機轉速，以達到節能效果",
          "保護功能： 需具備高低壓力保護、防凍保護、過載保護、欠相保護及自動復歸功能",
          "避震安裝： 主機須安裝於原廠提供之彈簧式避震器上，以減少運轉振動傳遞至建築結構",
          "空間留設： 散熱進出風口須依原廠要求留設足夠空間，避免熱氣短循環影響效率",
          "真空維持測試，停止泵運轉後維持 24 小時，真空度損失不得超過 50μm 水柱",
          "散熱鰭片的完整性（無倒片或壓傷）",
          "外部電源接線箱的防水等級"
        ]
      },
      {
        id: "ACH-2", name: "氣冷變頻式冰水主機 #2",
        basicInfo: { "製冷能力": "102 kW", "輸入功率": "34KW", "壓縮機": "1定1變頻", "電源": "480V / 3Ø / 60Hz", "冷媒": "R410a", "COP": "3.0" },
        checkItems: [
          "銘牌規格與設計相符",
          "防蝕處理： 散熱鋁片須進行防蝕處理（如藍色鰭片），底盤與機架應採用耐蝕材質或經防銹處理",
          "變頻調節功能： 主機須具備變頻（Inverter）驅動，可根據空調負載需求自動調整壓縮機轉速，以達到節能效果",
          "保護功能： 需具備高低壓力保護、防凍保護、過載保護、欠相保護及自動復歸功能",
          "避震安裝： 主機須安裝於原廠提供之彈簧式避震器上，以減少運轉振動傳遞至建築結構",
          "空間留設： 散熱進出風口須依原廠要求留設足夠空間，避免熱氣短循環影響效率",
          "真空維持測試，停止泵運轉後維持 24 小時，真空度損失不得超過 50μm 水柱",
          "散熱鰭片的完整性（無倒片或壓傷）",
          "外部電源接線箱的防水等級"
        ]
      },
      {
        id: "ACH-3", name: "氣冷變頻式冰水主機 #3",
        basicInfo: { "製冷能力": "68 kW", "輸入功率": "22.7KW", "壓縮機": "1定1變頻", "電源": "480V / 3Ø / 60Hz", "冷媒": "R410a", "COP": "3.0" },
        checkItems: [
          "銘牌規格與設計相符",
          "防蝕處理： 散熱鋁片須進行防蝕處理（如藍色鰭片），底盤與機架應採用耐蝕材質或經防銹處理",
          "變頻調節功能： 主機須具備變頻（Inverter）驅動，可根據空調負載需求自動調整壓縮機轉速，以達到節能效果",
          "保護功能： 需具備高低壓力保護、防凍保護、過載保護、欠相保護及自動復歸功能",
          "避震安裝： 主機須安裝於原廠提供之彈簧式避震器上，以減少運轉振動傳遞至建築結構",
          "空間留設： 散熱進出風口須依原廠要求留設足夠空間，避免熱氣短循環影響效率",
          "真空維持測試，停止泵運轉後維持 24 小時，真空度損失不得超過 50μm 水柱",
          "散熱鰭片的完整性（無倒片或壓傷）",
          "外部電源接線箱的防水等級"
        ]
      }
    ]
  },
  tab2: {
    title: "2. 水泵系統 (Pumps)",
    desc: "冷卻/冰水/滷水/區域泵浦群 (共23台)",
    items: [] // Dynamic
  },
  tab_ct: {
    title: "3. 冷卻水塔 (Cooling Towers)",
    desc: "超低噪音型/橫流式冷卻水塔 (共6座)",
    items: [] // Dynamic
  },
  tab_storage: {
    title: "4. 儲冰槽",
    desc: "動態製冰儲冰槽系列",
    items: [
      {
        id: "IST-1-1", name: "動態製冰儲冰槽 #1",
        basicInfo: { "材質": "SUS304 不鏽鋼", "板厚": "≧ 2.0 mm", "保溫厚度": "95 mm", "保溫值": "R18" },
        checkItems: ["銘牌規格與設計相符", "槽體保溫厚度(≧95mm) 實測", "儲冰盤管氣壓耐壓測試 (150 PSIG / 24hr)", "!!關鍵!! 24小時靜置熱損失測試 (<1.0%)", "攪拌泵運轉方向與平衡校正"]
      }
    ]
  },
  tab3: {
    title: "5. 板式熱交換器 (HEX)",
    desc: "Titanium 板片與高壓熱交換器",
    items: [
      { id: "HEX-01", name: "板式熱交換器 #1", basicInfo: { "板片材質": "鈦金屬", "設計壓力": "10 kg/cm2" }, checkItems: ["銘牌規格與設計相符", "逆洗管路與閥件功能測試", "進出水溫差與熱交換能力驗證", "外部保溫包覆檢查"] },
      { id: "HEX-02", name: "板式熱交換器 #2", basicInfo: { "板片材質": "鈦金屬", "設計壓力": "10 kg/cm2" }, checkItems: ["銘牌規格與設計相符", "逆洗管路與閥件功能測試", "進出水溫差與熱交換能力驗證", "外部保溫包覆檢查"] }
    ]
  },
  tab4: {
    title: "6. 空調箱 (AHU)",
    desc: "全館空調箱設備 (共49台)",
    items: [] // Dynamic with DB
  },
  tab5: {
    title: "7. 電力與變頻 (Elec.)",
    desc: "配電盤、變頻器與控制",
    items: [
      {
        id: "ACP-ALL", name: "低壓配電盤系統",
        basicInfo: { "盤體": "SS41 + 粉體烤漆", "漆膜厚度": "≧ 50μm", "防護等級": "IP42" },
        checkItems: ["銘牌規格與設計相符", "匯流排 (Bus bar) 扭力確認與色碼標示", "滿載熱顯像 (IR Scan) 溫升檢測", "接地電阻量測報告", "過載保護 (OL) 設定值核對"]
      }
    ]
  },
  tab_dehum: {
    title: "8. 除溼機 (Dehumidifiers)",
    desc: "DH-1 與 DH-2 型箱型除溼機",
    items: []
  },
  tab_expansion: {
    title: "9. 膨脹水箱 (Expansion Tanks)",
    desc: "CET/EXT 系列膨脹水箱",
    items: []
  },
  tab6: {
    title: "10. 文件與移交 (Docs)",
    desc: "教育訓練、竣工圖、TAB報告",
    items: [
      {
        id: "DOC-TAB", name: "TAB 測試平衡報告",
        basicInfo: { "標準": "NEBB Procedural Standards", "內容": "風側 + 水側" },
        checkItems: ["銘牌規格與設計相符", "水側系統流量平衡報告書", "全系統性能確效紀錄"]
      }
    ]
  }
};

// === 除溼機 (DH-1 / DH-2) ===
const dehumidifierConfig = [
  {
    type: "DH-1",
    name: "DH-1 箱型除溼機",
    count: 10,
    info: {
      "冷媒": "R-410a / 滾動式 Scroll",
      "風機": "內置散風機 + Fin coil",
      "控制": "中央監控 + 液位/排水警報"
    },
    checks: [
      "核對型號、風道、冷媒與電源相序是否與圖面一致",
      "排水系統包含自動閥、防逆流與平衡管路完整安裝",
      "通機測試除溼邏輯與液位警報 / 中央聯動輸出",
      "運轉時記錄噪音、振動與溫濕度抑制效率"
    ]
  },
  {
    type: "DH-2",
    name: "DH-2 箱型除溼機",
    count: 2,
    info: {
      "冷媒": "R-410a / 滾動式 Scroll",
      "風機": "高效 fin coil + 風機軸流",
      "控制": "中央監控 + 備用液位警報"
    },
    checks: [
      "確認冷媒與風機型式與安裝位置相符",
      "排水與壓差感測器、中央通信連線通暢",
      "除溼演算法、液位/排水/緊急停機測試合格",
      "運轉記錄噪音、振動與穩定性"
    ]
  }
];

dehumidifierConfig.forEach(cfg => {
  for (let i = 1; i <= cfg.count; i++) {
    defaultAppData.tab_dehum.items.push({
      id: `${cfg.type}-${String(i).padStart(2, '0')}`,
      name: `${cfg.name} #${i}`,
      basicInfo: cfg.info,
      checkItems: cfg.checks
    });
  }
});

// === 膨脹水箱 (CET/EXT) ===
const expansionConfig = [
  {
    id: "CET-1",
    name: "CET-1 滷水膨脹水箱",
    info: { "類型": "Diaphragm / Bladder", "容量": "50 L", "用途": "氯化鈉溶液系統" },
    checks: [
      "核對型號、容量與耐壓規格與圖樣一致",
      "液位感測器、溢流與補水管路完整接線",
      "1.5 倍工作壓力測試或氣壓差測試無洩漏",
      "檢查基座與固定螺栓無鬆脫"
    ]
  },
  {
    id: "EXT-1",
    name: "EXT-1 冰水膨脹水箱",
    info: { "類型": "開放式FRP", "容量": "1200 L", "用途": "冰水系統", "數量": "1" },
    checks: [
      "確認膨脹箱與氣壓閥、補水閥連接完整",
      "溢流管路方向與排水坡度正確",
      "安裝後進行氣壓/水壓測試且無滴漏",
      "排氣/排水閥順暢並連動警報"
    ]
  },
  {
    id: "EXT-2",
    name: "EXT-2 冰水膨脹水箱",
    info: { "類型": "開放式FRP", "容量": "400 L", "用途": "冰水系統", "數量": "2" },
    checks: [
      "確認膨脹箱與氣壓閥、補水閥連接完整",
      "溢流管路方向與排水坡度正確",
      "安裝後進行氣壓/水壓測試且無滴漏",
      "排氣/排水閥順暢並連動警報"
    ]
  },
  {
    id: "EXT-3",
    name: "EXT-3 冰水膨脹水箱",
    info: { "類型": "開放式FRP", "容量": "200 L", "用途": "冰水系統", "數量": "4" },
    checks: [
      "確認膨脹箱與氣壓閥、補水閥連接完整",
      "溢流管路方向與排水坡度正確",
      "安裝後進行氣壓/水壓測試且無滴漏",
      "排氣/排水閥順暢並連動警報"
    ]
  }
];

expansionConfig.forEach(cfg => {
  defaultAppData.tab_expansion.items.push({
    id: cfg.id,
    name: cfg.name,
    basicInfo: cfg.info,
    checkItems: cfg.checks
  });
});

// === 水泵設備 ===
// --- 生成 23 台水泵 ---
const pumpConfig = [
  { type: "CWP", start: 1, end: 3, name: "冷卻水泵", info: { "流量": "7200 LPM", "揚程": "240 kPa", "功率": "45KW", "效率": "82%" } },
  { type: "CWP", start: 4, end: 6, name: "冷卻水泵", info: { "流量": "5000 LPM", "揚程": "240 kPa", "功率": "30KW", "效率": "80%" } },
  { type: "CHP", start: 1, end: 3, name: "冰水循環泵", info: { "流量": "6000 LPM", "揚程": "160 kPa", "功率": "22KW", "效率": "78%" } },
  { type: "CHP", start: 4, end: 6, name: "冰水循環泵", info: { "流量": "4000 LPM", "揚程": "160 kPa", "功率": "15KW", "效率": "78%" } },
  { type: "BWP", start: 1, end: 3, name: "滷水循環泵", info: { "流量": "7000 LPM", "揚程": "180 kPa", "功率": "30KW", "效率": "80%" } },
  { type: "BWP", start: 4, end: 5, name: "滷水循環泵", info: { "流量": "7000 LPM", "揚程": "200 kPa", "功率": "30KW", "效率": "80%" } },
  { type: "ZP", start: 1, end: 3, name: "區域冰水泵", info: { "流量": "4550 LPM", "揚程": "180 kPa", "功率": "18.5KW", "效率": "80%" } },
  { type: "ZP", start: 4, end: 6, name: "區域冰水泵", info: { "流量": "3300 LPM", "揚程": "180 kPa", "功率": "15KW", "效率": "78%" } }
];

pumpConfig.forEach(cfg => {
  for (let i = cfg.start; i <= cfg.end; i++) {
    const id = `${cfg.type}-${String(i).padStart(2, '0')}`;
    const checks = [
      "銘牌規格與設計相符",
      "基礎座水平與防震軟管安裝，底座須裝設排水口，並以配管接至最接近的地板排水",
      "合格之工廠技術人員檢查、定位及簽認文件",
      "機械軸封運轉無漏水",
      "運轉振動值量測 (ISO 10816)",
      "馬達絕緣電阻測試，至少為 1.15，F 級或更好的絕緣",
      "電動機應為全密閉風扇冷卻",
      "管路連接： 鄰接泵浦之管線須獨立支撐，避免重量壓在泵浦身上",
      "原製造廠產品出廠證明，若為進口貨，應提交海關進口證明書",
      "水泵浦流量： 量測值與設計值之差異需在 +10% 以內"
    ];
    if (cfg.type === "ZP") checks.push("需依據系統壓差或負荷需求，透過中央監控系統進行 10%~110% 的調速運轉控制");

    defaultAppData.tab2.items.push({
      id: id, name: `${cfg.name} #${i}`, basicInfo: cfg.info, checkItems: checks
    });
  }
});

// === 冷卻水塔 ===
// --- 生成 2 座 冷卻水塔 (分 CT-1 / CT-2 規格) ---
const ctConfig = [
  {
    type: "CT-1",
    count: 1,
    spec: {
      "冷卻能力": "7,255 kW (27 m³/sec 空氣流量)",
      "風量 (CMM)": "33,600 CMM",
      "塔體": "FRP 塔體 + 鍍鋅鋼構支撐",
      "填料 (Fill)": "PVC 對齊板，符合 ASTM E84 不燃等級",
      "擋水器": "2或3折熱浸鍍鋅鋼板，確保水滴漂水損失在全部循環水量之 0.7% 以內",
      "五金配件": "所有螺帽、螺栓及墊圈等鐵件均應採用不銹鋼材質",
      "風機": "採 IE4 等級永磁式馬達，需為全密閉防水型，使用係數 (S.F.) 為 1.15",
      "噪音標準": "距離 1.5 m 測得 ≤ 70 dBA"
    },
    checks: [
      "銘牌規格與設計相符",
      "系統平衡 (TAB)： 驗收前需執行測試、調整及平衡，冷卻水流量與設計值差異須在 ± 10% 內",
      "Fill 板與消霧器安裝平整且符合防火要求",
      "風機正轉、振動、軸封與皮帶張力檢查",
      "補給水浮球閥控制與溢流管路連線完整，無滲漏，並維持水量平衡",
      "BEMS/Modbus 連線可讀出進出水水溫與風量數據，60 秒更新一次",
      "低水位/高水位加水、排水自動化功能工作正常",
      "噪音量測不超過 70 dBA，漂水檢查無飛霧",
      "須提供檢修門、梯子及人孔等通道以便日後維護"
    ]
  },
  {
    type: "CT-2",
    count: 1,
    spec: {
      "冷卻能力": "5,441 kW (27 m³/sec 空氣流量)",
      "風量 (CMM)": "26,400 CMM",
      "塔體": "FRP 塔體 + 鍍鋅鋼構支撐",
      "填料 (Fill)": "PVC 對齊板，符合 ASTM E84 不燃等級",
      "擋水器": "2或3折熱浸鍍鋅鋼板，確保水滴漂水損失在全部循環水量之 0.7% 以內",
      "五金配件": "所有螺帽、螺栓及墊圈等鐵件均應採用不銹鋼材質",
      "風機": "採 IE4 等級永磁式馬達，需為全密閉防水型，使用係數 (S.F.) 為 1.15",
      "噪音標準": "距離 1.5 m 測得 ≤ 70 dBA"
    },
    checks: [
      "銘牌規格與設計相符",
      "系統平衡 (TAB)： 驗收前需執行測試、調整及平衡，冷卻水流量與設計值差異須在 ± 10% 內",
      "Fill 板與消霧器安裝平整且符合防火要求",
      "風機正轉、振動、軸封與皮帶張力檢查",
      "補給水浮球閥控制與溢流管路連線完整，無滲漏，並維持水量平衡",
      "BEMS/Modbus 連線可讀出進出水水溫與風量數據，60 秒更新一次",
      "低水位/高水位加水、排水自動化功能工作正常",
      "噪音量測不超過 70 dBA，漂水檢查無飛霧",
      "須提供檢修門、梯子及人孔等通道以便日後維護"
    ]
  }
];
let towerIndex = 1;
ctConfig.forEach(cfg => {
  for (let i = 1; i <= cfg.count; i++) {
    defaultAppData.tab_ct.items.push({
      id: `${cfg.type}-${String(i).padStart(2, '0')}`,
      name: `冷卻水塔 (Cooling Tower) #${towerIndex}`,
      basicInfo: cfg.spec,
      checkItems: cfg.checks
    });
    towerIndex += 1;
  }
});

// === 儲冰槽 ===
// --- 生成 IST 2-8 ---
for (let i = 2; i <= 8; i++) {
  defaultAppData.tab_storage.items.splice(i - 1, 0, {
    id: `IST-1-${i}`, name: `動態製冰儲冰槽 #${i}`,
    basicInfo: { "材質": "SUS304 不鏽鋼", "板厚": "≧ 2.0 mm", "保溫厚度": "95 mm" },
    checkItems: ["銘牌規格與設計相符", "槽體保溫厚度(≧95mm) 實測", "儲冰盤管氣壓耐壓測試", "24小時靜置熱損失測試", "攪拌泵運轉方向與平衡校正"]
  });
}

// === 空調箱 (AHU) ===
// --- 生成 49 台 AHU ---
for (let i = 1; i <= 49; i++) {
  const id = `AH-${String(i).padStart(2, '0')}`;
  const dbData = ahuDatabase[id] || { cmh: "現場確認", pa: "現場確認", kw: "-", motor: "-" };

  const basicInfo = {
    "風量 (CMH)": dbData.cmh,
    "機外靜壓 (Pa)": dbData.pa,
    "冷房能力 (kW)": dbData.kw,
    "馬達 (kW)": dbData.motor,
    "結構": "Double Skin (雙層板)"
  };

  const checkItems = [
    "型號/序號與送審資料核對",
    "箱體外觀無損傷且內部清潔",
    "雙層板(Double Skin)氣密測試無洩漏",
    "盤管水壓/氣壓耐壓測試 (1035kPa)",
    "排水盤洩水坡度測試",
    "濾網壓差計安裝確認",
    "[TAB] 風量測試與設計值誤差 < 10%"
  ];

  if (dbData.heater) {
    basicInfo["電熱器 (kW)"] = dbData.heater;
    checkItems.push("!!關鍵!! 電熱器絕緣電阻與過熱保護測試");
    checkItems.push("電熱器運轉電流與三相平衡確認");
  }

  if (dbData.humid) {
    basicInfo["加濕器 (kg/hr)"] = dbData.humid;
    checkItems.push("加濕器給水管路無洩漏測試");
    checkItems.push("加濕器噴霧/蒸氣產生功能測試");
    checkItems.push("濕度感知器連鎖控制測試");
  }

  defaultAppData.tab4.items.push({
    id: id,
    name: `空氣調節箱 ${id}`,
    basicInfo: basicInfo,
    checkItems: checkItems
  });
}
